"use strict";(()=>{const e=window.matchMedia&&window.matchMedia("(prefers-reduced-motion: reduce)"),t=!(!e||!e.matches),n=!(!navigator.connection||!navigator.connection.saveData),a=t||n,o={enabled:!1,anime:!1},i={primary:"#8b5cf6",accent:"#22d3ee",clearRGB:"0,0,0"};function r(){try{const e=getComputedStyle(document.documentElement),t=e.getPropertyValue("--primary").trim(),n=e.getPropertyValue("--accent").trim(),a=e.getPropertyValue("--fx-clear").trim();t&&(i.primary=t),n&&(i.accent=n),a&&(i.clearRGB=a)}catch{}}let l=null,c=null,s=null,d=0,h=0,m=1,u=0,f=!1,M=0,p=[];const y="01{}[]()<>/\\|+-=_*#@~$%&;:".split("");let g=16,w=[],x=[];function b(e,t,n){return Math.max(t,Math.min(n,e))}function v(e,t=document){return t.querySelector(e)}function P(){return l=v(".fx-layer"),c=v("#fx-canvas"),l||(l=document.createElement("div"),l.className="fx-layer",l.setAttribute("aria-hidden","true"),document.body.prepend(l)),c||(c=document.createElement("canvas"),c.id="fx-canvas",l.appendChild(c)),s=c.getContext("2d",{alpha:!0,desynchronized:!0}),!!s&&(E(),window.addEventListener("resize",A,{passive:!0}),document.addEventListener("visibilitychange",()=>{document.hidden?k():F()}),e&&e.addEventListener?.("change",()=>{e.matches?k(!0):F()}),!0)}let $=0;function A(){const e=performance.now();e-$<120||($=e,E())}function E(){d=Math.max(1,window.innerWidth||document.documentElement.clientWidth||1),h=Math.max(1,window.innerHeight||document.documentElement.clientHeight||1),m=b(window.devicePixelRatio||1,1,2),c.width=Math.floor(d*m),c.height=Math.floor(h*m),c.style.width=d+"px",c.style.height=h+"px",s.setTransform(m,0,0,m,0,0),r(),function(){const e=d<=820;g=e?18:16;const t=Math.floor(d/g);p=new Array(t).fill(0).map((t,n)=>{const a=(e?.55:.85)+Math.random()*(e?.65:1.05);return{x:n*g,y:Math.random()*h,speed:a,step:12+Math.floor(12*Math.random())}})}(),function(){const e=d<=820,t=b(Math.floor(d*h/(e?52e3:36e3)),16,e?34:52);w=new Array(t).fill(0).map(()=>S(!0)),x=[]}()}function S(e){const t=6+12*Math.random();return{x:Math.random()*d,y:e?Math.random()*h:-20-80*Math.random(),vx:.5*Math.random()-.25,vy:.55+1.25*Math.random(),rot:Math.random()*Math.PI*2,vr:.04*Math.random()-.02,size:t,sway:.6+1.4*Math.random(),phase:6.2*Math.random(),kind:Math.random()<.72?"spark":"kana",glyph:Math.random()<.5?"☆":Math.random()<.5?"✦":Math.random()<.5?"✧":"ツ",hue:210+90*Math.random(),alpha:.26+.18*Math.random()}}function B(e,t){return{x:e,y:t,r:.5+1.8*Math.random(),a:.35+.35*Math.random(),life:0,ttl:1.2+.8*Math.random(),vx:.3*Math.random()-.15,vy:-.35-.7*Math.random()}}function L(e){const t=i.clearRGB||"0,0,0";s.fillStyle=`rgba(${t},${e})`,s.fillRect(0,0,d,h)}function C(e){if(!f)return;M||(M=e);const t=e-M;if(t<22)return void(u=requestAnimationFrame(C));const n=b(t/1e3,0,.05);M=e,o.enabled||o.anime?(t>180&&s.clearRect(0,0,d,h),o.enabled&&function(e){s.save(),s.font='12px ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace',L(o.anime?.14:.1);const t=i.accent||"#22d3ee",n=i.primary||"#8b5cf6";for(let a=0;a<p.length;a++){const i=p[a];i.y+=i.speed*(60*e),i.y>h+40&&(i.y=-20,i.speed=.65+1.25*Math.random());const r=o.anime?2:3;for(let e=0;e<r;e++){const r=i.y-e*i.step;if(r<-24||r>h+24)continue;const l=y[Math.random()*y.length|0],c=a/Math.max(1,p.length);s.fillStyle=0===e?`rgba(255,255,255,${o.anime?.1:.16})`:`rgba(255,255,255,${o.anime?.05:.08})`,s.shadowBlur=o.anime?10:14,s.shadowColor=c<.5?t:n,s.fillText(l,i.x,r)}}s.restore()}(n),o.anime&&function(e){o.enabled||L(.12);for(let t=0;t<w.length;t++){const n=w[t];if(n.phase+=1.4*e,n.x+=(n.vx+.35*Math.sin(n.phase)*n.sway)*(60*e),n.y+=n.vy*(60*e),n.rot+=n.vr*(60*e),n.y>h+40||n.x<-60||n.x>d+60){w[t]=S(!1);continue}s.save(),s.translate(n.x,n.y),s.rotate(n.rot);const a=n.size;if(s.globalAlpha=n.alpha,s.shadowBlur=16,s.shadowColor=`hsla(${n.hue}, 90%, 65%, 0.35)`,s.strokeStyle=`hsla(${n.hue}, 85%, 70%, ${.35*n.alpha})`,s.lineWidth=Math.max(1,.08*a),s.beginPath(),s.moveTo(-Math.min(18,18*n.vx),-Math.min(18,10*n.vy)),s.lineTo(0,0),s.stroke(),"kana"===n.kind)s.shadowBlur=18,s.fillStyle=`hsla(${n.hue}, 92%, 78%, ${n.alpha})`,s.font=`${Math.round(10+a)}px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto`,s.textAlign="center",s.textBaseline="middle",s.fillText(n.glyph,0,0);else{s.fillStyle=`hsla(${n.hue}, 92%, 74%, ${n.alpha})`;const e=.55*a,t=.18*a;s.beginPath();for(let n=0;n<8;n++){const a=Math.PI/4*n,o=n%2==0?e:t;s.lineTo(Math.cos(a)*o,Math.sin(a)*o)}s.closePath(),s.fill(),s.shadowBlur=0,s.globalAlpha=.55*n.alpha,s.fillStyle="rgba(255,255,255,0.9)",s.beginPath(),s.arc(0,0,Math.max(1.2,.06*a),0,2*Math.PI),s.fill()}s.restore()}if(x.length)for(let t=x.length-1;t>=0;t--){const n=x[t];n.life+=e,n.x+=n.vx*(60*e),n.y+=n.vy*(60*e);const a=n.life/n.ttl;if(a>=1){x.splice(t,1);continue}const o=n.a*(1-a);s.save(),s.globalAlpha=o,s.fillStyle="rgba(255,255,255,1)",s.shadowBlur=14,s.shadowColor="rgba(255,110,180,0.55)",s.beginPath(),s.arc(n.x,n.y,n.r*(1+.8*a),0,2*Math.PI),s.fill(),s.restore()}x.length>80&&(x.length=80)}(n),u=requestAnimationFrame(C)):k()}function R(){f||a||(c&&s||P())&&(f=!0,M=0,u=requestAnimationFrame(C))}function k(e=!1){f=!1,u&&cancelAnimationFrame(u),u=0,M=0,e&&s&&s.clearRect(0,0,d,h)}function F(){a||document.hidden||(o.enabled||o.anime)&&R()}function T(e){o.enabled=!(!e||!e.enabled),o.anime=!(!e||!e.anime),r(),l||(o.enabled||o.anime)&&P(),l&&l.classList.toggle("is-on",(o.enabled||o.anime)&&!a),a?k(!0):o.enabled||o.anime?R():k(!0)}window.EBFX={lowPower:a,set:T,start:R,stop:k},document.addEventListener("DOMContentLoaded",()=>{window.matchMedia&&window.matchMedia("(pointer: fine)").matches&&document.addEventListener("pointerdown",e=>{if(!o.anime||a)return;if(0!==e.button)return;const t=e.clientX,n=e.clientY;for(let e=0;e<6;e++)x.push(B(t+(12*Math.random()-6),n+(12*Math.random()-6)))},{passive:!0});const e=document.body,t=e.classList.contains("fx-on"),n=e.classList.contains("anime-on");(t||n)&&T({enabled:t,anime:n})})})();